<Page
    x:Class="FileRenamer.Views.Pages.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controlExtensions="using:FileRenamer.Helpers.Controls.Extensions"
    xmlns:root="using:FileRenamer.Services.Root"
    xmlns:pageViewModel="using:FileRenamer.ViewModels.Pages"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    RequestedTheme="{x:Bind ViewModel.WindowTheme, Mode=OneWay}"
    SizeChanged="{x:Bind OnSizeChanged}"
    mc:Ignorable="d">

    <Page.DataContext>
        <pageViewModel:MainViewModel x:Name="ViewModel" x:FieldModifier="public" />
    </Page.DataContext>

    <Grid>
        <NavigationView
            AlwaysShowHeader="False"
            BackRequested="{x:Bind ViewModel.OnNavigationViewBackRequested}"
            Canvas.ZIndex="0"
            IsBackEnabled="{x:Bind ViewModel.IsBackEnabled, Mode=OneWay}"
            IsSettingsVisible="False"
            Loaded="{x:Bind ViewModel.OnNavigationViewLoaded}"
            PaneDisplayMode="Top"
            SelectedItem="{x:Bind ViewModel.SelectedItem, Mode=OneWay}"
            Style="{StaticResource NavigationViewStyle}">

            <NavigationView.MenuItems>
                <NavigationViewItem
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/FileName')}"
                    Tag="{x:Bind ViewModel.TagList[0]}"
                    Tapped="{x:Bind ViewModel.OnTapped}">

                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE8a5;" Style="{StaticResource SegoeFluentStyle}" />
                    </NavigationViewItem.Icon>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            Content="{x:Bind root:ResourceService.GetLocalized('Window/FileName')}"
                            Placement="Bottom"
                            VerticalOffset="20" />
                    </ToolTipService.ToolTip>
                </NavigationViewItem>

                <NavigationViewItem
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/ExtensionName')}"
                    Tag="{x:Bind ViewModel.TagList[1]}"
                    Tapped="{x:Bind ViewModel.OnTapped}">

                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE8a6;" Style="{StaticResource SegoeFluentStyle}" />
                    </NavigationViewItem.Icon>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            Content="{x:Bind root:ResourceService.GetLocalized('Window/ExtensionName')}"
                            Placement="Bottom"
                            VerticalOffset="20" />
                    </ToolTipService.ToolTip>
                </NavigationViewItem>

                <NavigationViewItem
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/UpperAndLowerCase')}"
                    Tag="{x:Bind ViewModel.TagList[2]}"
                    Tapped="{x:Bind ViewModel.OnTapped}">

                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE8e9;" Style="{StaticResource SegoeFluentStyle}" />
                    </NavigationViewItem.Icon>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            Content="{x:Bind root:ResourceService.GetLocalized('Window/UpperAndLowerCase')}"
                            Placement="Bottom"
                            VerticalOffset="20" />
                    </ToolTipService.ToolTip>
                </NavigationViewItem>

                <NavigationViewItem
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/FileProperties')}"
                    Tag="{x:Bind ViewModel.TagList[3]}"
                    Tapped="{x:Bind ViewModel.OnTapped}">

                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE90f;" Style="{StaticResource SegoeFluentStyle}" />
                    </NavigationViewItem.Icon>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            Content="{x:Bind root:ResourceService.GetLocalized('Window/FileProperties')}"
                            Placement="Bottom"
                            VerticalOffset="20" />
                    </ToolTipService.ToolTip>
                </NavigationViewItem>

                <NavigationViewItemSeparator />

                <NavigationViewItem
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/About')}"
                    Tag="{x:Bind ViewModel.TagList[4]}"
                    Tapped="{x:Bind ViewModel.OnTapped}">

                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE946;" Style="{StaticResource SegoeFluentStyle}" />
                    </NavigationViewItem.Icon>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            Content="{x:Bind root:ResourceService.GetLocalized('Window/About')}"
                            Placement="Bottom"
                            VerticalOffset="20" />
                    </ToolTipService.ToolTip>
                </NavigationViewItem>

                <NavigationViewItem
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/Settings')}"
                    Tag="{x:Bind ViewModel.TagList[5]}"
                    Tapped="{x:Bind ViewModel.OnTapped}">

                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE713;" Style="{StaticResource SegoeFluentStyle}" />
                    </NavigationViewItem.Icon>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            Content="{x:Bind root:ResourceService.GetLocalized('Window/Settings')}"
                            Placement="Bottom"
                            VerticalOffset="20" />
                    </ToolTipService.ToolTip>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <NavigationView.PaneFooter>
                <Grid>
                    <DropDownButton
                        x:Name="AboutButton"
                        controlExtensions:CursorHelper.Cursor="Hand"
                        x:Load="{x:Bind ViewModel.IsAboutPage, Mode=OneWay}"
                        Content="{x:Bind root:ResourceService.GetLocalized('Window/Others')}">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                Content="{x:Bind root:ResourceService.GetLocalized('Window/OthersToolTip')}"
                                Placement="Bottom"
                                VerticalOffset="25" />
                        </ToolTipService.ToolTip>

                        <DropDownButton.Flyout>
                            <MenuFlyout Placement="Bottom">
                                <MenuFlyoutItem Click="{x:Bind ViewModel.OnCreateDesktopShortcutClicked}" Text="{x:Bind root:ResourceService.GetLocalized('Window/CreateDesktopShortcut')}">
                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            Content="{x:Bind root:ResourceService.GetLocalized('Window/CreateDesktopShortcutToolTip')}"
                                            Placement="Bottom"
                                            VerticalOffset="20" />
                                    </ToolTipService.ToolTip>
                                </MenuFlyoutItem>

                                <MenuFlyoutItem Click="{x:Bind ViewModel.OnPinToStartScreenClicked}" Text="{x:Bind root:ResourceService.GetLocalized('Window/PinToStartScreen')}">
                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            Content="{x:Bind root:ResourceService.GetLocalized('Window/PinToStartScreenToolTip')}"
                                            Placement="Bottom"
                                            VerticalOffset="20" />
                                    </ToolTipService.ToolTip>
                                </MenuFlyoutItem>

                                <!--<MenuFlyoutItem
                                    Click="{x:Bind ViewModel.OnPinToTaskbarClicked}"
                                    Text="{x:Bind root:ResourceService.GetLocalized('Window/PinToTaskbar')}"
                                    Visibility="Collapsed">
                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            Content="{x:Bind root:ResourceService.GetLocalized('Window/PinToTaskbarToolTip')}"
                                            Placement="Bottom"
                                            VerticalOffset="20" />
                                    </ToolTipService.ToolTip>
                                </MenuFlyoutItem>-->

                                <MenuFlyoutSeparator />

                                <MenuFlyoutItem Click="{x:Bind ViewModel.OnShowReleaseNotesClicked}" Text="{x:Bind root:ResourceService.GetLocalized('Window/ShowReleaseNotes')}">
                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            Content="{x:Bind root:ResourceService.GetLocalized('Window/ShowReleaseNotesToolTip')}"
                                            Placement="Bottom"
                                            VerticalOffset="20" />
                                    </ToolTipService.ToolTip>
                                </MenuFlyoutItem>

                                <MenuFlyoutItem Click="{x:Bind ViewModel.OnShowLicenseClicked}" Text="{x:Bind root:ResourceService.GetLocalized('Window/ShowLicense')}">
                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            Content="{x:Bind root:ResourceService.GetLocalized('Window/ShowLicenseToolTip')}"
                                            Placement="Bottom"
                                            VerticalOffset="20" />
                                    </ToolTipService.ToolTip>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </DropDownButton.Flyout>
                    </DropDownButton>

                    <Button
                        x:Name="RestartButton"
                        controlExtensions:CursorHelper.Cursor="Hand"
                        x:Load="{x:Bind ViewModel.IsSettingsPage, Mode=OneWay}"
                        Click="{x:Bind ViewModel.OnRestartAppsClicked}"
                        Content="{x:Bind root:ResourceService.GetLocalized('Window/RestartApp')}">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                Content="{x:Bind root:ResourceService.GetLocalized('Window/RestartAppToolTip')}"
                                Placement="Bottom"
                                VerticalOffset="20" />
                        </ToolTipService.ToolTip>
                    </Button>
                </Grid>
            </NavigationView.PaneFooter>

            <Frame
                x:Name="MainFrame"
                Navigated="{x:Bind ViewModel.OnFrameNavigated}"
                NavigationFailed="{x:Bind ViewModel.OnFrameNavgationFailed}">
                <Frame.ContentTransitions>
                    <TransitionCollection>
                        <NavigationThemeTransition />
                    </TransitionCollection>
                </Frame.ContentTransitions>
            </Frame>
        </NavigationView>
    </Grid>
</Page>
