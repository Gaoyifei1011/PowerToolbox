<Page
    x:Class="FileRenamer.Views.Pages.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:navigation="using:FileRenamer.Views.CustomControls.Navigation"
    xmlns:pageViewModel="using:FileRenamer.ViewModels.Pages"
    xmlns:root="using:FileRenamer.Services.Root"
    NavigationCacheMode="Enabled"
    mc:Ignorable="d">

    <Page.DataContext>
        <pageViewModel:MainViewModel x:Name="ViewModel" x:FieldModifier="public" />
    </Page.DataContext>

    <Grid RequestedTheme="{x:Bind ViewModel.WindowTheme, Mode=OneWay}">
        <NavigationView
            AlwaysShowHeader="False"
            BackRequested="{x:Bind ViewModel.OnNavigationViewBackRequested}"
            Canvas.ZIndex="0"
            IsBackEnabled="{x:Bind ViewModel.IsBackEnabled, Mode=OneWay}"
            IsSettingsVisible="False"
            Loaded="{x:Bind ViewModel.OnNavigationViewLoaded}"
            PaneDisplayMode="Top"
            SelectedItem="{x:Bind ViewModel.SelectedItem, Mode=OneWay}"
            Style="{StaticResource NavigationViewStyle}">

            <NavigationView.MenuItems>
                <navigation:ExtendedNavigationViewItem
                    Command="{x:Bind ViewModel.NavigationItemCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Tag}"
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/FileName')}"
                    Tag="FileName"
                    ToolTip="{x:Bind root:ResourceService.GetLocalized('Window/FileName')}">
                    <navigation:ExtendedNavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE8a5;" Style="{StaticResource SegoeFluentStyle}" />
                    </navigation:ExtendedNavigationViewItem.Icon>
                </navigation:ExtendedNavigationViewItem>

                <navigation:ExtendedNavigationViewItem
                    Command="{x:Bind ViewModel.NavigationItemCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Tag}"
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/ExtensionName')}"
                    Tag="ExtensionName"
                    ToolTip="{x:Bind root:ResourceService.GetLocalized('Window/ExtensionName')}">
                    <navigation:ExtendedNavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE8a6;" Style="{StaticResource SegoeFluentStyle}" />
                    </navigation:ExtendedNavigationViewItem.Icon>
                </navigation:ExtendedNavigationViewItem>

                <navigation:ExtendedNavigationViewItem
                    Command="{x:Bind ViewModel.NavigationItemCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Tag}"
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/UpperAndLowerCase')}"
                    Tag="UpperAndLowerCase"
                    ToolTip="{x:Bind root:ResourceService.GetLocalized('Window/UpperAndLowerCase')}">
                    <navigation:ExtendedNavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE8e9;" Style="{StaticResource SegoeFluentStyle}" />
                    </navigation:ExtendedNavigationViewItem.Icon>
                </navigation:ExtendedNavigationViewItem>

                <navigation:ExtendedNavigationViewItem
                    Command="{x:Bind ViewModel.NavigationItemCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Tag}"
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/FileProperties')}"
                    Tag="FileProperties"
                    ToolTip="{x:Bind root:ResourceService.GetLocalized('Window/FileProperties')}">
                    <navigation:ExtendedNavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE90f;" Style="{StaticResource SegoeFluentStyle}" />
                    </navigation:ExtendedNavigationViewItem.Icon>
                </navigation:ExtendedNavigationViewItem>

                <NavigationViewItemSeparator />

                <navigation:ExtendedNavigationViewItem
                    Command="{x:Bind ViewModel.NavigationItemCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Tag}"
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/About')}"
                    Tag="About"
                    ToolTip="{x:Bind root:ResourceService.GetLocalized('Window/About')}">
                    <navigation:ExtendedNavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE946;" Style="{StaticResource SegoeFluentStyle}" />
                    </navigation:ExtendedNavigationViewItem.Icon>
                </navigation:ExtendedNavigationViewItem>

                <navigation:ExtendedNavigationViewItem
                    Command="{x:Bind ViewModel.NavigationItemCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Tag}"
                    Content="{x:Bind root:ResourceService.GetLocalized('Window/Settings')}"
                    Tag="Settings"
                    ToolTip="{x:Bind root:ResourceService.GetLocalized('Window/Settings')}">
                    <navigation:ExtendedNavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE713;" Style="{StaticResource SegoeFluentStyle}" />
                    </navigation:ExtendedNavigationViewItem.Icon>
                </navigation:ExtendedNavigationViewItem>
            </NavigationView.MenuItems>

            <Frame
                x:Name="MainFrame"
                Navigated="{x:Bind ViewModel.OnFrameNavigated}"
                NavigationFailed="{x:Bind ViewModel.OnFrameNavgationFailed}">
                <Frame.ContentTransitions>
                    <TransitionCollection>
                        <NavigationThemeTransition />
                    </TransitionCollection>
                </Frame.ContentTransitions>
            </Frame>
        </NavigationView>
    </Grid>
</Page>
