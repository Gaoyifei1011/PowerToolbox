<Page
    x:Class="PowerToolbox.Views.Pages.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:Microsoft.UI.Xaml.Controls"
    xmlns:converter="using:PowerToolbox.Helpers.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:roothelper="using:PowerToolbox.Helpers.Root"
    xmlns:rootservice="using:PowerToolbox.Services.Root"
    xmlns:settingsservice="using:PowerToolbox.Services.Settings"
    x:Name="MainContent"
    FlowDirection="{x:Bind GetControlDirection(settingsservice:LanguageService.RightToLeft)}"
    RequestedTheme="{x:Bind WindowTheme, Mode=OneWay}"
    mc:Ignorable="d">

    <Grid>
        <Grid
            x:Name="AppTitlebar"
            Height="45"
            Margin="45,0,0,0"
            VerticalAlignment="Top"
            x:FieldModifier="public">

            <Grid.Resources>
                <MenuFlyout
                    x:Name="TitlebarMenuFlyout"
                    x:FieldModifier="public"
                    Placement="BottomEdgeAlignedLeft">

                    <MenuFlyoutItem
                        Height="28"
                        Padding="11,0"
                        Click="{x:Bind OnRestoreClicked}"
                        FontSize="12"
                        IsEnabled="{x:Bind GetWindowMaximizeState(IsWindowMaximized, IsWindowMaximizeEnabled, x:String.Empty), Mode=OneWay}"
                        Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Restore')}">

                        <MenuFlyoutItem.Icon>
                            <FontIcon Margin="6" Glyph="&#xE923;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>

                    <MenuFlyoutItem
                        Height="28"
                        Padding="11,0"
                        Click="{x:Bind OnMoveClicked}"
                        FontSize="12"
                        IsEnabled="{x:Bind converter:ValueConverterHelper.BooleanReverseConvert(IsWindowMaximized), Mode=OneWay}"
                        Tag="{x:Bind TitlebarMenuFlyout}"
                        Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Move')}" />

                    <MenuFlyoutItem
                        Height="28"
                        Padding="11,0"
                        Click="{x:Bind OnSizeClicked}"
                        FontSize="12"
                        IsEnabled="{x:Bind converter:ValueConverterHelper.BooleanReverseConvert(IsWindowMaximized), Mode=OneWay}"
                        Tag="{x:Bind TitlebarMenuFlyout}"
                        Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Size')}" />

                    <MenuFlyoutItem
                        Height="28"
                        Padding="11,0"
                        Click="{x:Bind OnMinimizeClicked}"
                        FontSize="12"
                        Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Minimize')}">

                        <MenuFlyoutItem.Icon>
                            <FontIcon Margin="6" Glyph="&#xE921;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>

                    <MenuFlyoutItem
                        Height="28"
                        Padding="11,0"
                        Click="{x:Bind OnMaximizeClicked}"
                        FontSize="12"
                        IsEnabled="{x:Bind GetWindowMaximizeState(IsWindowMaximized, IsWindowMaximizeEnabled, 'isReverse'), Mode=OneWay}"
                        Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Maximize')}">

                        <MenuFlyoutItem.Icon>
                            <FontIcon Margin="6" Glyph="&#xE922;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>

                    <MenuFlyoutSeparator Width="200" />

                    <MenuFlyoutItem
                        Height="28"
                        Padding="11,0"
                        Click="{x:Bind OnCloseClicked}"
                        FontSize="12"
                        Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Close')}">

                        <MenuFlyoutItem.Icon>
                            <FontIcon Margin="6" Glyph="&#xE8BB;" />
                        </MenuFlyoutItem.Icon>

                        <MenuFlyoutItem.KeyboardAccelerators>
                            <KeyboardAccelerator Key="F4" Modifiers="Menu" />
                        </MenuFlyoutItem.KeyboardAccelerators>
                    </MenuFlyoutItem>
                </MenuFlyout>
            </Grid.Resources>

            <!--  标题栏图标和应用名称  -->
            <Grid
                HorizontalAlignment="Stretch"
                VerticalAlignment="Center"
                Canvas.ZIndex="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="22" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Image
                    x:Name="TitleBarIcon"
                    Grid.Column="0"
                    Width="18"
                    Height="18"
                    Margin="2,3,0,0"
                    HorizontalAlignment="Left"
                    Source="ms-appx:///Assets/Square44x44Logo.altform-unplated_targetsize-256.png" />

                <TextBlock
                    x:Name="TitleRunNormalText"
                    Grid.Column="1"
                    Margin="12,2,0,0"
                    VerticalAlignment="Center"
                    FontSize="12"
                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('WindowTitle')}"
                    TextWrapping="NoWrap" />

                <TextBlock
                    x:Name="TitleRunAdministratorText"
                    Grid.Column="2"
                    Margin="0,2,0,0"
                    VerticalAlignment="Center"
                    FontSize="12"
                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('RunningAdministrator')}"
                    TextWrapping="NoWrap"
                    Visibility="{x:Bind roothelper:RuntimeHelper.IsElevated}" />
            </Grid>

            <StackPanel
                x:Name="CaptionButtons"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                x:FieldModifier="public"
                Orientation="Horizontal">

                <Button
                    x:Name="MinimizeButton"
                    Grid.Column="1"
                    Width="46.0"
                    Height="{StaticResource CaptionButtonHeightWindowed}"
                    MinWidth="46.0"
                    VerticalAlignment="Top"
                    AutomationProperties.AccessibilityView="Raw"
                    IsEnabled="{x:Bind IsWindowMinimizeEnabled, Mode=OneWay}"
                    Style="{StaticResource CaptionButton}">
                    <Button.Resources>
                        <ResourceDictionary>
                            <ResourceDictionary.ThemeDictionaries>
                                <ResourceDictionary x:Key="Light">
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="MinimizeGlyph" />
                                </ResourceDictionary>
                                <ResourceDictionary x:Key="Dark">
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="MinimizeGlyph" />
                                </ResourceDictionary>
                                <ResourceDictionary x:Key="HighContrast">
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="MinimizeGlyphContrast" />
                                </ResourceDictionary>
                            </ResourceDictionary.ThemeDictionaries>
                        </ResourceDictionary>
                    </Button.Resources>
                </Button>

                <Button
                    x:Name="MaximizeButton"
                    Grid.Column="2"
                    Width="46.0"
                    Height="{StaticResource CaptionButtonHeightWindowed}"
                    MinWidth="46.0"
                    VerticalAlignment="Top"
                    AutomationProperties.AccessibilityView="Raw"
                    IsEnabled="{x:Bind IsWindowMaximizeEnabled, Mode=OneWay}"
                    Style="{StaticResource CaptionButton}">
                    <Button.Resources>
                        <ResourceDictionary>
                            <ResourceDictionary.ThemeDictionaries>
                                <ResourceDictionary x:Key="Light">
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="MaximizeGlyph" />
                                </ResourceDictionary>
                                <ResourceDictionary x:Key="Dark">
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="MaximizeGlyph" />
                                </ResourceDictionary>
                                <ResourceDictionary x:Key="HighContrast">
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="MaximizeGlyphContrast" />
                                </ResourceDictionary>
                            </ResourceDictionary.ThemeDictionaries>
                        </ResourceDictionary>
                    </Button.Resources>
                </Button>

                <Button
                    x:Name="CloseButton"
                    Grid.Column="3"
                    Width="46.0"
                    Height="{StaticResource CaptionButtonHeightWindowed}"
                    MinWidth="46.0"
                    VerticalAlignment="Top"
                    AutomationProperties.AccessibilityView="Raw"
                    Style="{StaticResource CaptionButton}">
                    <Button.Resources>
                        <ResourceDictionary>
                            <ResourceDictionary.ThemeDictionaries>
                                <ResourceDictionary x:Key="Light">
                                    <StaticResource x:Key="CaptionButtonBackgroundPointerOver" ResourceKey="CloseButtonBackgroundPointerOver" />
                                    <StaticResource x:Key="CaptionButtonBackgroundPressed" ResourceKey="CloseButtonBackgroundPressed" />
                                    <StaticResource x:Key="CaptionButtonForegroundPointerOver" ResourceKey="CloseButtonForegroundPointerOver" />
                                    <StaticResource x:Key="CaptionButtonForegroundPressed" ResourceKey="CloseButtonForegroundPressed" />
                                    <StaticResource x:Key="CaptionButtonBackground" ResourceKey="CloseButtonBackground" />
                                    <StaticResource x:Key="CaptionButtonBackgroundColor" ResourceKey="CloseButtonBackgroundColor" />
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="CloseGlyph" />
                                </ResourceDictionary>
                                <ResourceDictionary x:Key="Dark">
                                    <StaticResource x:Key="CaptionButtonBackgroundPointerOver" ResourceKey="CloseButtonBackgroundPointerOver" />
                                    <StaticResource x:Key="CaptionButtonBackgroundPressed" ResourceKey="CloseButtonBackgroundPressed" />
                                    <StaticResource x:Key="CaptionButtonForegroundPointerOver" ResourceKey="CloseButtonForegroundPointerOver" />
                                    <StaticResource x:Key="CaptionButtonForegroundPressed" ResourceKey="CloseButtonForegroundPressed" />
                                    <StaticResource x:Key="CaptionButtonBackground" ResourceKey="CloseButtonBackground" />
                                    <StaticResource x:Key="CaptionButtonBackgroundColor" ResourceKey="CloseButtonBackgroundColor" />
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="CloseGlyph" />
                                </ResourceDictionary>
                                <ResourceDictionary x:Key="HighContrast">
                                    <StaticResource x:Key="CaptionButtonBackgroundPointerOver" ResourceKey="CloseButtonBackgroundPointerOver" />
                                    <StaticResource x:Key="CaptionButtonBackgroundPressed" ResourceKey="CloseButtonBackgroundPressed" />
                                    <StaticResource x:Key="CaptionButtonForegroundPointerOver" ResourceKey="CloseButtonForegroundPointerOver" />
                                    <StaticResource x:Key="CaptionButtonForegroundPressed" ResourceKey="CloseButtonForegroundPressed" />
                                    <StaticResource x:Key="CaptionButtonGlyph" ResourceKey="CloseGlyphContrast" />
                                </ResourceDictionary>
                            </ResourceDictionary.ThemeDictionaries>
                        </ResourceDictionary>
                    </Button.Resources>
                </Button>
            </StackPanel>
        </Grid>

        <controls:NavigationView
            x:Name="MainNavigationView"
            x:FieldModifier="public"
            AlwaysShowHeader="False"
            BackRequested="{x:Bind OnBackRequested}"
            Canvas.ZIndex="0"
            Collapsed="{x:Bind OnCollapsed}"
            Expanding="{x:Bind OnExpanding}"
            IsBackButtonVisible="Visible"
            IsBackEnabled="{x:Bind IsBackEnabled, Mode=OneWay}"
            IsPaneToggleButtonVisible="False"
            IsSettingsVisible="False"
            ItemInvoked="{x:Bind OnItemInvoked}"
            Loaded="{x:Bind OnLoaded}"
            OpenPaneLength="220"
            PaneDisplayMode="Left"
            SelectedItem="{x:Bind SelectedItem, Mode=OneWay}">

            <controls:NavigationView.Resources>
                <SolidColorBrush x:Key="NavigationViewContentBackground" Color="Transparent" />
                <SolidColorBrush x:Key="NavigationViewContentGridBorderBrush" Color="Transparent" />
                <Thickness x:Key="NavigationViewContentMargin">0,30,0,0</Thickness>
            </controls:NavigationView.Resources>

            <controls:NavigationView.MenuItems>
                <!--  所有工具  -->
                <controls:NavigationViewItem Tag="AllTools">

                    <controls:NavigationViewItem.Icon>
                        <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/AllTools.png" />
                    </controls:NavigationViewItem.Icon>

                    <controls:NavigationViewItem.Content>
                        <TextBlock
                            x:Name="WindowAllToolsText"
                            Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('AllTools')}"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="NoWrap" />
                    </controls:NavigationViewItem.Content>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            MaxWidth="9999"
                            Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('AllTools')}"
                            Visibility="{x:Bind WindowAllToolsText.IsTextTrimmed, Mode=OneWay}" />
                    </ToolTipService.ToolTip>
                </controls:NavigationViewItem>

                <controls:NavigationViewItemSeparator Margin="0,0,6,0" />

                <!--  休闲工具  -->
                <controls:NavigationViewItem Tag="Relaxation">

                    <controls:NavigationViewItem.Icon>
                        <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/Relaxation.png" />
                    </controls:NavigationViewItem.Icon>

                    <controls:NavigationViewItem.Content>
                        <TextBlock
                            x:Name="WindowRelaxationText"
                            Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Relaxation')}"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="NoWrap" />
                    </controls:NavigationViewItem.Content>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            MaxWidth="9999"
                            Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('Relaxation')}"
                            Visibility="{x:Bind WindowRelaxationText.IsTextTrimmed, Mode=OneWay}" />
                    </ToolTipService.ToolTip>

                    <controls:NavigationViewItem.MenuItems>
                        <controls:NavigationViewItem Tag="Loaf">

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowLoafText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Loaf')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/Loaf.png" />
                            </controls:NavigationViewItem.Icon>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('Loaf')}"
                                    Visibility="{x:Bind WindowLoafText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>
                    </controls:NavigationViewItem.MenuItems>
                </controls:NavigationViewItem>

                <!--  文件工具  -->
                <controls:NavigationViewItem Tag="File">

                    <controls:NavigationViewItem.Icon>
                        <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/File.png" />
                    </controls:NavigationViewItem.Icon>

                    <controls:NavigationViewItem.Content>
                        <TextBlock
                            x:Name="WindowFileText"
                            Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('File')}"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="NoWrap" />
                    </controls:NavigationViewItem.Content>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            MaxWidth="9999"
                            Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('File')}"
                            Visibility="{x:Bind WindowFileText.IsTextTrimmed, Mode=OneWay}" />
                    </ToolTipService.ToolTip>

                    <controls:NavigationViewItem.MenuItems>
                        <controls:NavigationViewItem Tag="FileManager">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/FileManager.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowFileManagerText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('FileManager')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('FileManager')}"
                                    Visibility="{x:Bind WindowFileManagerText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="FileCertificate">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/FileCertificate.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowFileCertificateText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('FileCertificate')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('FileCertificate')}"
                                    Visibility="{x:Bind WindowFileCertificateText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="FileUnlock">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/FileUnlock.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowFileUnlockText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('FileUnlock')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('FileUnlock')}"
                                    Visibility="{x:Bind WindowFileUnlockText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>
                    </controls:NavigationViewItem.MenuItems>
                </controls:NavigationViewItem>

                <!--  资源工具  -->
                <controls:NavigationViewItem Tag="Resource">

                    <controls:NavigationViewItem.Icon>
                        <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/Resource.png" />
                    </controls:NavigationViewItem.Icon>

                    <controls:NavigationViewItem.Content>
                        <TextBlock
                            x:Name="WindowResourceText"
                            Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Resource')}"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="NoWrap" />
                    </controls:NavigationViewItem.Content>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            MaxWidth="9999"
                            Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('Resource')}"
                            Visibility="{x:Bind WindowResourceText.IsTextTrimmed, Mode=OneWay}" />
                    </ToolTipService.ToolTip>

                    <controls:NavigationViewItem.MenuItems>
                        <controls:NavigationViewItem Tag="DownloadManager">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/DownloadManager.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowDownloadManagerText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('DownloadManager')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('DownloadManager')}"
                                    Visibility="{x:Bind WindowDownloadManagerText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="IconExtract">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/IconExtract.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowIconExtractText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('IconExtract')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('IconExtract')}"
                                    Visibility="{x:Bind WindowIconExtractText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="PriExtract">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/PriExtract.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowPriExtractText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('PriExtract')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('PriExtract')}"
                                    Visibility="{x:Bind WindowPriExtractText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>
                    </controls:NavigationViewItem.MenuItems>
                </controls:NavigationViewItem>

                <!--  个性化工具  -->
                <controls:NavigationViewItem Tag="Personalize">

                    <controls:NavigationViewItem.Icon>
                        <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/Personalize.png" />
                    </controls:NavigationViewItem.Icon>

                    <controls:NavigationViewItem.Content>
                        <TextBlock
                            x:Name="WindowPersonalizeText"
                            Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Personalize')}"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="NoWrap" />
                    </controls:NavigationViewItem.Content>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            MaxWidth="9999"
                            Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('Personalize')}"
                            Visibility="{x:Bind WindowPersonalizeText.IsTextTrimmed, Mode=OneWay}" />
                    </ToolTipService.ToolTip>

                    <controls:NavigationViewItem.MenuItems>
                        <controls:NavigationViewItem Tag="ThemeSwitch">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/ThemeSwitch.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="ThemeSwitchText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('ThemeSwitch')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('ThemeSwitch')}"
                                    Visibility="{x:Bind ThemeSwitchText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="ShellMenu">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/ShellMenu.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowShellMenuText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('ShellMenu')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('ShellMenu')}"
                                    Visibility="{x:Bind WindowShellMenuText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="ContextMenuManager">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/ContextMenuManager.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowContextMenuManagerText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('ContextMenuManager')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('ContextMenuManager')}"
                                    Visibility="{x:Bind WindowContextMenuManagerText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>
                    </controls:NavigationViewItem.MenuItems>
                </controls:NavigationViewItem>

                <!--  系统工具  -->
                <controls:NavigationViewItem Tag="System">

                    <controls:NavigationViewItem.Icon>
                        <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/System.png" />
                    </controls:NavigationViewItem.Icon>

                    <controls:NavigationViewItem.Content>
                        <TextBlock
                            x:Name="WindowSystemText"
                            Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('System')}"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="NoWrap" />
                    </controls:NavigationViewItem.Content>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            MaxWidth="9999"
                            Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('System')}"
                            Visibility="{x:Bind WindowSystemText.IsTextTrimmed, Mode=OneWay}" />
                    </ToolTipService.ToolTip>

                    <controls:NavigationViewItem.MenuItems>
                        <controls:NavigationViewItem Tag="LoopbackManager">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/LoopbackManager.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowLoopbackManagerText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('LoopbackManager')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('LoopbackManager')}"
                                    Visibility="{x:Bind WindowLoopbackManagerText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="Hosts">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/Hosts.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowHostsText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Hosts')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('Hosts')}"
                                    Visibility="{x:Bind WindowHostsText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="DriverManager">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/DriverManager.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowDriverManagerText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('DriverManager')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('DriverManager')}"
                                    Visibility="{x:Bind WindowDriverManagerText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="UpdateManager">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/UpdateManager.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowUpdateManagerText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('UpdateManager')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('UpdateManager')}"
                                    Visibility="{x:Bind WindowUpdateManagerText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>

                        <controls:NavigationViewItem Tag="WinSAT">

                            <controls:NavigationViewItem.Icon>
                                <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/WinSAT.png" />
                            </controls:NavigationViewItem.Icon>

                            <controls:NavigationViewItem.Content>
                                <TextBlock
                                    x:Name="WindowWinSATText"
                                    Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('WinSAT')}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap" />
                            </controls:NavigationViewItem.Content>

                            <ToolTipService.ToolTip>
                                <ToolTip
                                    MaxWidth="9999"
                                    Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('WinSAT')}"
                                    Visibility="{x:Bind WindowWinSATText.IsTextTrimmed, Mode=OneWay}" />
                            </ToolTipService.ToolTip>
                        </controls:NavigationViewItem>
                    </controls:NavigationViewItem.MenuItems>
                </controls:NavigationViewItem>
            </controls:NavigationView.MenuItems>

            <controls:NavigationView.FooterMenuItems>
                <controls:NavigationViewItem Tag="Settings">

                    <controls:NavigationViewItem.Icon>
                        <controls:ImageIcon Source="ms-appx:///Assets/ControlIcon/Settings.png" />
                    </controls:NavigationViewItem.Icon>

                    <controls:NavigationViewItem.Content>
                        <TextBlock
                            x:Name="WindowSettingsText"
                            Text="{x:Bind rootservice:ResourceService.WindowResource.GetString('Settings')}"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="NoWrap" />
                    </controls:NavigationViewItem.Content>

                    <ToolTipService.ToolTip>
                        <ToolTip
                            MaxWidth="9999"
                            Content="{x:Bind rootservice:ResourceService.WindowResource.GetString('Settings')}"
                            Visibility="{x:Bind WindowSettingsText.IsTextTrimmed, Mode=OneWay}" />
                    </ToolTipService.ToolTip>
                </controls:NavigationViewItem>
            </controls:NavigationView.FooterMenuItems>

            <Frame Navigated="{x:Bind OnNavigated}" NavigationFailed="{x:Bind OnNavigationFailed}">
                <Frame.ContentTransitions>
                    <TransitionCollection>
                        <NavigationThemeTransition />
                    </TransitionCollection>
                </Frame.ContentTransitions>
            </Frame>
        </controls:NavigationView>

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState x:Name="BackgroundDefault">
                    <VisualState.Setters>
                        <Setter Target="MainContent.Background" Value="{ThemeResource DefaultBackgroundColorBrush}" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="BackgroundTransparent" />
            </VisualStateGroup>

            <VisualStateGroup>
                <VisualState x:Name="TitlebarTitleActivate">
                    <VisualState.Setters>
                        <Setter Target="TitleBarIcon.Opacity" Value="1" />
                        <Setter Target="TitleRunNormalText.Foreground" Value="{ThemeResource TextFillColorPrimaryBrush}" />
                        <Setter Target="TitleRunAdministratorText.Foreground" Value="{ThemeResource TextFillColorPrimaryBrush}" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="TitlebarTitleDeactive">
                    <VisualState.Setters>
                        <Setter Target="TitleBarIcon.Opacity" Value="0.5" />
                        <Setter Target="TitleRunNormalText.Foreground" Value="{ThemeResource TextFillColorTertiaryBrush}" />
                        <Setter Target="TitleRunAdministratorText.Foreground" Value="{ThemeResource TextFillColorTertiaryBrush}" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</Page>
