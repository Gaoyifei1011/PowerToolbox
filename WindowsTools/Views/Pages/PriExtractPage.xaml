<Page
    x:Class="WindowsTools.Views.Pages.PriExtractPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converter="using:WindowsTools.Helpers.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:model="using:WindowsTools.Models"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:root="using:WindowsTools.Services.Root"
    xmlns:sys="using:System"
    AllowDrop="True"
    NavigationCacheMode="Enabled"
    mc:Ignorable="d">

    <Page.Resources>
        <CornerRadius x:Key="ListViewItemCornerRadius">0</CornerRadius>
        <SolidColorBrush x:Key="ListViewItemBackgroundPointerOver" Color="Transparent" />
        <SolidColorBrush x:Key="ListViewItemBackgroundPressed" Color="Transparent" />

        <XamlUICommand x:Name="LanguageCommand" ExecuteRequested="{x:Bind OnLanguageExecuteRequested}" />
        <XamlUICommand x:Name="StringCommand" ExecuteRequested="{x:Bind OnStringExecuteRequested}" />
        <XamlUICommand x:Name="FilePathCommand" ExecuteRequested="{x:Bind OnFilePathExecuteRequested}" />
        <XamlUICommand x:Name="EmbeddedDataCommand" ExecuteRequested="{x:Bind OnEmbeddedDataExecuteRequested}" />
    </Page.Resources>

    <Grid Padding="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock
            Grid.Row="0"
            Margin="30,15,30,6"
            FontSize="22"
            Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Title')}" />

        <TextBlock
            x:Name="GetResultsText"
            Grid.Row="1"
            Margin="32,0,32,3"
            FontSize="14"
            Text="{x:Bind GetResults, Mode=OneWay}"
            TextTrimming="CharacterEllipsis"
            TextWrapping="NoWrap">

            <ToolTipService.ToolTip>
                <ToolTip
                    MaxWidth="9999"
                    Content="{x:Bind GetResults, Mode=OneWay}"
                    Visibility="{x:Bind GetResultsText.IsTextTrimmed, Mode=OneWay}" />
            </ToolTipService.ToolTip>
        </TextBlock>

        <Grid Grid.Row="2" Margin="30,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!--  字符串资源  -->
            <Grid
                Grid.Column="0"
                Margin="0,0,0,5"
                Background="{ThemeResource LayerFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="{StaticResource ControlCornerRadius}">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Grid
                    Grid.Row="0"
                    Height="35"
                    Padding="6,0,0,0"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="0,0,0,1"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[0].Value), Mode=OneWay}">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="100" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="70" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        IsTapEnabled="True"
                        Tapped="{x:Bind OnStringSelectTapped}"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Select')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip MaxWidth="9999" Content="{x:Bind root:ResourceService.PriExtractResource.GetString('SelectDescription')}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="StringKeyHeaderText"
                        Grid.Column="1"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Key')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Key')}"
                                Visibility="{x:Bind StringKeyHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="StringLanguageHeaderText"
                        Grid.Column="2"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Language')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Language')}"
                                Visibility="{x:Bind StringLanguageHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="StringContentHeaderText"
                        Grid.Column="3"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Content')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Content')}"
                                Visibility="{x:Bind StringContentHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="StringOperationHeaderText"
                        Grid.Column="4"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Operation')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Operation')}"
                                Visibility="{x:Bind StringOperationHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>
                </Grid>

                <ListView
                    Grid.Row="1"
                    Margin="0,0,0,3"
                    IsItemClickEnabled="True"
                    ItemClick="{x:Bind OnStringItemClicked}"
                    ItemsSource="{x:Bind StringCollection, Mode=OneWay}"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                    ScrollViewer.HorizontalScrollMode="Disabled"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.VerticalScrollMode="Enabled"
                    SelectionMode="None"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[0].Value), Mode=OneWay}">

                    <ListView.ItemContainerStyle>
                        <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="Margin" Value="0" />
                            <Setter Property="MinHeight" Value="0" />
                            <Setter Property="Padding" Value="0" />
                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="model:StringModel">
                            <Grid
                                Height="35"
                                Padding="6,0,0,0"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="0,0,0,1">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="100" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="70" />
                                </Grid.ColumnDefinitions>

                                <CheckBox
                                    Grid.Column="0"
                                    Width="50"
                                    MinWidth="0"
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    IsChecked="{x:Bind IsSelected, Mode=TwoWay}"
                                    IsThreeState="False">

                                    <ToolTipService.ToolTip>
                                        <ToolTip MaxWidth="9999">
                                            <Grid>
                                                <TextBlock Text="{x:Bind root:ResourceService.PriExtractResource.GetString('SelectedToolTip')}" Visibility="{x:Bind IsSelected, Mode=OneWay}" />
                                                <TextBlock Text="{x:Bind root:ResourceService.PriExtractResource.GetString('UnSelectedToolTip')}" Visibility="{x:Bind converter:ValueConverterHelper.BooleanToVisibilityReverseConvert(IsSelected), Mode=OneWay}" />
                                            </Grid>
                                        </ToolTip>
                                    </ToolTipService.ToolTip>
                                </CheckBox>

                                <TextBlock
                                    x:Name="StringKeyText"
                                    Grid.Column="1"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Text="{x:Bind Key}"
                                    TextAlignment="Left"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap">

                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            MaxWidth="9999"
                                            Content="{x:Bind Key}"
                                            Visibility="{Binding ElementName=StringKeyText, Path=IsTextTrimmed, Mode=OneWay}" />
                                    </ToolTipService.ToolTip>
                                </TextBlock>

                                <TextBlock
                                    x:Name="StringLanguageText"
                                    Grid.Column="2"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Text="{x:Bind Language}"
                                    TextAlignment="Left"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap">

                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            MaxWidth="9999"
                                            Content="{x:Bind Language}"
                                            Visibility="{Binding ElementName=StringLanguageText, Path=IsTextTrimmed, Mode=OneWay}" />
                                    </ToolTipService.ToolTip>
                                </TextBlock>

                                <TextBlock
                                    x:Name="StringContentText"
                                    Grid.Column="3"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Text="{x:Bind Content}"
                                    TextAlignment="Left"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap">

                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            MaxWidth="9999"
                                            Content="{x:Bind Content}"
                                            Visibility="{Binding ElementName=StringContentText, Path=IsTextTrimmed, Mode=OneWay}" />
                                    </ToolTipService.ToolTip>
                                </TextBlock>

                                <HyperlinkButton
                                    Grid.Column="4"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    Command="{StaticResource StringCommand}"
                                    CommandParameter="{Binding}"
                                    Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Copy')}"
                                    Style="{StaticResource HyperlinkButtonStyle}" />
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <Grid
                    Grid.Row="1"
                    Margin="0,10,0,0"
                    VerticalAlignment="Top"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[0].Value), Mode=OneWay}">

                    <TextBlock
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('EmptyList')}"
                        TextAlignment="Center"
                        Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityReverseConvert(StringCollection.Count), Mode=OneWay}" />
                </Grid>

                <!--  文件路径资源  -->
                <Grid
                    Grid.Row="0"
                    Height="35"
                    Padding="6,0,0,0"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="0,0,0,1"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[1].Value), Mode=OneWay}">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="70" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        IsTapEnabled="True"
                        Tapped="{x:Bind OnFilePathSelectTapped}"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Select')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip MaxWidth="9999" Content="{x:Bind root:ResourceService.PriExtractResource.GetString('SelectDescription')}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="FilePathKeyHeaderText"
                        Grid.Column="1"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Key')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Key')}"
                                Visibility="{x:Bind FilePathKeyHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="FilePathAbsolutePathHeaderText"
                        Grid.Column="2"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('AbsolutePath')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('AbsolutePath')}"
                                Visibility="{x:Bind FilePathAbsolutePathHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="FilePathOperationHeaderText"
                        Grid.Column="3"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Operation')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Operation')}"
                                Visibility="{x:Bind FilePathOperationHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>
                </Grid>

                <ListView
                    Grid.Row="1"
                    Margin="0,0,0,3"
                    IsItemClickEnabled="True"
                    ItemClick="{x:Bind OnFilePathItemClicked}"
                    ItemsSource="{x:Bind FilePathCollection, Mode=OneWay}"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                    ScrollViewer.HorizontalScrollMode="Disabled"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.VerticalScrollMode="Enabled"
                    SelectionMode="None"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[1].Value), Mode=OneWay}">

                    <ListView.ItemContainerStyle>
                        <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="Margin" Value="0" />
                            <Setter Property="MinHeight" Value="0" />
                            <Setter Property="Padding" Value="0" />
                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="model:FilePathModel">
                            <Grid
                                Height="35"
                                Padding="6,0,0,0"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="0,0,0,1">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="70" />
                                </Grid.ColumnDefinitions>

                                <CheckBox
                                    Grid.Column="0"
                                    Width="50"
                                    MinWidth="0"
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    IsChecked="{x:Bind IsSelected, Mode=TwoWay}"
                                    IsThreeState="False">

                                    <ToolTipService.ToolTip>
                                        <ToolTip MaxWidth="9999">
                                            <Grid>
                                                <TextBlock Text="{x:Bind root:ResourceService.PriExtractResource.GetString('SelectedToolTip')}" Visibility="{x:Bind IsSelected, Mode=OneWay}" />
                                                <TextBlock Text="{x:Bind root:ResourceService.PriExtractResource.GetString('UnSelectedToolTip')}" Visibility="{x:Bind converter:ValueConverterHelper.BooleanToVisibilityReverseConvert(IsSelected), Mode=OneWay}" />
                                            </Grid>
                                        </ToolTip>
                                    </ToolTipService.ToolTip>
                                </CheckBox>

                                <TextBlock
                                    x:Name="FilePathKeyText"
                                    Grid.Column="1"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Text="{x:Bind Key}"
                                    TextAlignment="Left"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap">

                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            MaxWidth="9999"
                                            Content="{x:Bind Key}"
                                            Visibility="{Binding ElementName=FilePathKeyText, Path=IsTextTrimmed, Mode=OneWay}" />
                                    </ToolTipService.ToolTip>
                                </TextBlock>

                                <TextBlock
                                    x:Name="FilePathAbsolutePathText"
                                    Grid.Column="2"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Text="{x:Bind AbsolutePath}"
                                    TextAlignment="Left"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap">

                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            MaxWidth="9999"
                                            Content="{x:Bind AbsolutePath}"
                                            Visibility="{Binding ElementName=FilePathAbsolutePathText, Path=IsTextTrimmed, Mode=OneWay}" />
                                    </ToolTipService.ToolTip>
                                </TextBlock>

                                <HyperlinkButton
                                    Grid.Column="3"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    Command="{StaticResource FilePathCommand}"
                                    CommandParameter="{Binding}"
                                    Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Copy')}"
                                    Style="{StaticResource HyperlinkButtonStyle}" />
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <Grid
                    Grid.Row="1"
                    Margin="0,10,0,0"
                    VerticalAlignment="Top"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[1].Value), Mode=OneWay}">

                    <TextBlock
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('EmptyList')}"
                        TextAlignment="Center"
                        Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityReverseConvert(FilePathCollection.Count), Mode=OneWay}" />
                </Grid>

                <!--  嵌入数据资源  -->
                <Grid
                    Grid.Row="0"
                    Height="35"
                    Padding="6,0,0,0"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="0,0,0,1"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[2].Value), Mode=OneWay}">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="70" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        IsTapEnabled="True"
                        Tapped="{x:Bind OnEmbeddedDataSelectTapped}"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Select')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip MaxWidth="9999" Content="{x:Bind root:ResourceService.PriExtractResource.GetString('SelectDescription')}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="EmbeddedDataKeyHeaderText"
                        Grid.Column="1"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Key')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Key')}"
                                Visibility="{x:Bind EmbeddedDataKeyHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>

                    <TextBlock
                        x:Name="EmbeddedDataOperationHeaderText"
                        Grid.Column="2"
                        Margin="10,0,0,0"
                        VerticalAlignment="Center"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('Operation')}"
                        TextTrimming="CharacterEllipsis"
                        TextWrapping="NoWrap">

                        <ToolTipService.ToolTip>
                            <ToolTip
                                MaxWidth="9999"
                                Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Operation')}"
                                Visibility="{x:Bind EmbeddedDataOperationHeaderText.IsTextTrimmed, Mode=OneWay}" />
                        </ToolTipService.ToolTip>
                    </TextBlock>
                </Grid>

                <ListView
                    Grid.Row="1"
                    Margin="0,0,0,3"
                    IsItemClickEnabled="True"
                    ItemClick="{x:Bind OnEmbeddedDataItemClicked}"
                    ItemsSource="{x:Bind EmbeddedDataCollection, Mode=OneWay}"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                    ScrollViewer.HorizontalScrollMode="Disabled"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.VerticalScrollMode="Enabled"
                    SelectionMode="None"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[2].Value), Mode=OneWay}">

                    <ListView.ItemContainerStyle>
                        <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="Margin" Value="0" />
                            <Setter Property="MinHeight" Value="0" />
                            <Setter Property="Padding" Value="0" />
                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="model:EmbeddedDataModel">
                            <Grid
                                Height="35"
                                Padding="6,0,0,0"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="0,0,0,1">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="70" />
                                </Grid.ColumnDefinitions>

                                <CheckBox
                                    Grid.Column="0"
                                    Width="50"
                                    MinWidth="0"
                                    Margin="10,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    IsChecked="{x:Bind IsSelected, Mode=TwoWay}"
                                    IsThreeState="False">

                                    <ToolTipService.ToolTip>
                                        <ToolTip MaxWidth="9999">
                                            <Grid>
                                                <TextBlock Text="{x:Bind root:ResourceService.PriExtractResource.GetString('SelectedToolTip')}" Visibility="{x:Bind IsSelected, Mode=OneWay}" />
                                                <TextBlock Text="{x:Bind root:ResourceService.PriExtractResource.GetString('UnSelectedToolTip')}" Visibility="{x:Bind converter:ValueConverterHelper.BooleanToVisibilityReverseConvert(IsSelected), Mode=OneWay}" />
                                            </Grid>
                                        </ToolTip>
                                    </ToolTipService.ToolTip>
                                </CheckBox>

                                <TextBlock
                                    x:Name="EmbeddedDataKeyText"
                                    Grid.Column="1"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Text="{x:Bind Key}"
                                    TextAlignment="Left"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="NoWrap">

                                    <ToolTipService.ToolTip>
                                        <ToolTip
                                            MaxWidth="9999"
                                            Content="{x:Bind Key}"
                                            Visibility="{Binding ElementName=EmbeddedDataKeyText, Path=IsTextTrimmed, Mode=OneWay}" />
                                    </ToolTipService.ToolTip>
                                </TextBlock>

                                <HyperlinkButton
                                    Grid.Column="2"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    Command="{StaticResource EmbeddedDataCommand}"
                                    CommandParameter="{Binding}"
                                    Content="{x:Bind root:ResourceService.PriExtractResource.GetString('Extract')}"
                                    Style="{StaticResource HyperlinkButtonStyle}" />
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <Grid
                    Grid.Row="1"
                    Margin="0,10,0,0"
                    VerticalAlignment="Top"
                    Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Value, ResourceCandidateKindList[2].Value), Mode=OneWay}">

                    <TextBlock
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('EmptyList')}"
                        TextAlignment="Center"
                        Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityReverseConvert(EmbeddedDataCollection.Count), Mode=OneWay}" />
                </Grid>
            </Grid>

            <AppBarSeparator Grid.Column="1" Margin="10,0" />

            <Grid Grid.Column="2" Width="260">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0">

                    <TextBlock
                        Margin="0,0,0,3"
                        FontSize="16"
                        Text="{x:Bind root:ResourceService.PriExtractResource.GetString('ExtractOptions')}" />

                    <CheckBox
                        Click="{x:Bind OnExtractSaveSamelyClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('ExtractSaveSamely')}"
                        IsChecked="{x:Bind IsExtractSaveSamely, Mode=TwoWay}" />

                    <CheckBox
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('ExtractSaveString')}"
                        IsChecked="{x:Bind IsExtractSaveString, Mode=TwoWay}"
                        IsEnabled="{x:Bind IsExtractSaveSamely, Mode=OneWay}" />

                    <CheckBox
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('ExtractSaveFilePath')}"
                        IsChecked="{x:Bind IsExtractSaveFilePath, Mode=TwoWay}"
                        IsEnabled="{x:Bind IsExtractSaveSamely, Mode=OneWay}" />

                    <CheckBox
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('ExtractSaveEmbeddedData')}"
                        IsChecked="{x:Bind IsExtractSaveEmbeddedData, Mode=TwoWay}"
                        IsEnabled="{x:Bind IsExtractSaveSamely, Mode=OneWay}" />

                    <MenuFlyoutSeparator Grid.Row="5" Margin="5,3" />

                    <Button
                        HorizontalAlignment="Stretch"
                        Click="{x:Bind OnSelectSaveFolderClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('SelectSaveFolder')}"
                        IsEnabled="{x:Bind IsExtractSaveSamely, Mode=OneWay}"
                        ToolTipService.ToolTip="{x:Bind x:String.Format(SelectedFolder, SelectedSaveFolder), Mode=OneWay}" />

                    <MenuFlyoutSeparator Margin="5,3" />

                    <Button
                        Margin="0,0,0,3"
                        HorizontalAlignment="Stretch"
                        Click="{x:Bind OnSelectFileClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('SelectFile')}" />

                    <muxc:DropDownButton
                        x:Name="LanguageButton"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        Content="{x:Bind sys:Convert.ToString(SelectedLanguage.Value), Mode=OneWay}"
                        IsEnabled="{x:Bind sys:Convert.ToBoolean(LanguageCollection.Count), Mode=OneWay}"
                        Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind, ResourceCandidateKindList[0]), Mode=OneWay}">

                        <muxc:DropDownButton.Flyout>
                            <Flyout
                                x:Name="LanguageFlyout"
                                Opened="{x:Bind OnOpened}"
                                Placement="Bottom"
                                ShouldConstrainToRootBounds="False">

                                <Flyout.FlyoutPresenterStyle>
                                    <Style BasedOn="{StaticResource DefaultFlyoutPresenterStyle}" TargetType="FlyoutPresenter">
                                        <Setter Property="Padding" Value="0" />
                                        <Setter Property="MinHeight" Value="0" />
                                        <Setter Property="MinWidth" Value="260" />
                                    </Style>
                                </Flyout.FlyoutPresenterStyle>

                                <ListView
                                    x:Name="LanguageListView"
                                    MaxHeight="300"
                                    Background="Transparent"
                                    ItemsSource="{x:Bind LanguageCollection, Mode=OneWay}"
                                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                    ScrollViewer.HorizontalScrollMode="Disabled"
                                    ScrollViewer.VerticalScrollBarVisibility="Visible"
                                    ScrollViewer.VerticalScrollMode="Enabled"
                                    SelectionMode="None">

                                    <ListView.ItemContainerStyle>
                                        <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                                            <Setter Property="Padding" Value="0" />
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                            <Setter Property="Margin" Value="0,1" />
                                            <Setter Property="MinHeight" Value="0 " />
                                        </Style>
                                    </ListView.ItemContainerStyle>

                                    <ItemsControl.ItemContainerTransitions>
                                        <TransitionCollection />
                                    </ItemsControl.ItemContainerTransitions>

                                    <ListView.ItemTemplate>
                                        <DataTemplate x:DataType="model:LanguageModel">
                                            <muxc:RadioMenuFlyoutItem
                                                Height="32"
                                                Padding="11,0"
                                                Command="{StaticResource LanguageCommand}"
                                                CommandParameter="{x:Bind}"
                                                GroupName="LanguageRadioGroup"
                                                IsChecked="{x:Bind IsChecked, Mode=OneWay}"
                                                Text="{x:Bind sys:Convert.ToString(LangaugeInfo.Value)}" />
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Flyout>
                        </muxc:DropDownButton.Flyout>
                    </muxc:DropDownButton>

                    <MenuFlyoutSeparator Margin="5,3,5,3" />

                    <muxc:DropDownButton
                        Margin="0,0,0,3"
                        HorizontalAlignment="Stretch"
                        Content="{x:Bind SelectedResourceCandidateKind.Value, Mode=OneWay}">

                        <muxc:DropDownButton.Flyout>
                            <MenuFlyout Placement="Bottom">
                                <MenuFlyout.MenuFlyoutPresenterStyle>
                                    <Style BasedOn="{StaticResource DefaultMenuFlyoutPresenterStyle}" TargetType="MenuFlyoutPresenter">
                                        <Setter Property="MinWidth" Value="260" />
                                    </Style>
                                </MenuFlyout.MenuFlyoutPresenterStyle>

                                <muxc:RadioMenuFlyoutItem
                                    Height="32"
                                    Padding="11,0"
                                    Click="{x:Bind OnSelectedResourceCandidateKindClicked}"
                                    GroupName="ResourceCandidateKindRadioGroup"
                                    IsChecked="{x:Bind SelectedResourceCandidateKind.Key.Equals(ResourceCandidateKindList[0].Key), Mode=OneWay}"
                                    Tag="0"
                                    Text="{x:Bind sys:Convert.ToString(ResourceCandidateKindList[0].Value)}" />

                                <muxc:RadioMenuFlyoutItem
                                    Height="32"
                                    Padding="11,0"
                                    Click="{x:Bind OnSelectedResourceCandidateKindClicked}"
                                    GroupName="ResourceCandidateKindRadioGroup"
                                    IsChecked="{x:Bind SelectedResourceCandidateKind.Key.Equals(ResourceCandidateKindList[1].Key), Mode=OneWay}"
                                    Tag="1"
                                    Text="{x:Bind sys:Convert.ToString(ResourceCandidateKindList[1].Value)}" />

                                <muxc:RadioMenuFlyoutItem
                                    Height="32"
                                    Padding="11,0"
                                    Click="{x:Bind OnSelectedResourceCandidateKindClicked}"
                                    GroupName="ResourceCandidateKindRadioGroup"
                                    IsChecked="{x:Bind SelectedResourceCandidateKind.Key.Equals(ResourceCandidateKindList[2].Key), Mode=OneWay}"
                                    Tag="2"
                                    Text="{x:Bind sys:Convert.ToString(ResourceCandidateKindList[2].Value)}" />
                            </MenuFlyout>
                        </muxc:DropDownButton.Flyout>
                    </muxc:DropDownButton>

                    <Button
                        Margin="0,0,0,3"
                        HorizontalAlignment="Stretch"
                        Click="{x:Bind OnCopySelectedStringClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('CopySelectedString')}"
                        IsEnabled="{x:Bind sys:Convert.ToBoolean(StringCollection.Count), Mode=OneWay}"
                        Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Key, ResourceCandidateKindList[0].Key), Mode=OneWay}" />

                    <Button
                        Margin="0,0,0,3"
                        HorizontalAlignment="Stretch"
                        Click="{x:Bind OnCopySelectedFilePathClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('CopySelectedFilePath')}"
                        IsEnabled="{x:Bind sys:Convert.ToBoolean(FilePathCollection.Count), Mode=OneWay}"
                        Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Key, ResourceCandidateKindList[1].Key), Mode=OneWay}" />

                    <Button
                        Margin="0,0,0,3"
                        HorizontalAlignment="Stretch"
                        Click="{x:Bind OnExportSelectedEmbeddedDataClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('ExportSelectedEmbeddedData')}"
                        IsEnabled="{x:Bind sys:Convert.ToBoolean(EmbeddedDataCollection.Count), Mode=OneWay}"
                        Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Key, ResourceCandidateKindList[2].Key), Mode=OneWay}" />

                    <Button
                        HorizontalAlignment="Stretch"
                        Click="{x:Bind OnCopyAllStringClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('CopyAllString')}"
                        IsEnabled="{x:Bind sys:Convert.ToBoolean(StringCollection.Count), Mode=OneWay}"
                        Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Key, ResourceCandidateKindList[0].Key), Mode=OneWay}" />

                    <Button
                        HorizontalAlignment="Stretch"
                        Click="{x:Bind OnCopyAllFilePathClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('CopyAllFilePath')}"
                        IsEnabled="{x:Bind sys:Convert.ToBoolean(FilePathCollection.Count), Mode=OneWay}"
                        Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Key, ResourceCandidateKindList[1].Key), Mode=OneWay}" />

                    <Button
                        HorizontalAlignment="Stretch"
                        Click="{x:Bind OnExportAllEmbeddedDataClicked}"
                        Content="{x:Bind root:ResourceService.PriExtractResource.GetString('ExportAllEmbeddedData')}"
                        IsEnabled="{x:Bind sys:Convert.ToBoolean(EmbeddedDataCollection.Count), Mode=OneWay}"
                        Visibility="{x:Bind converter:ValueConverterHelper.ObjectToVisibilityConvert(SelectedResourceCandidateKind.Key, ResourceCandidateKindList[2].Key), Mode=OneWay}" />
                </StackPanel>

                <StackPanel
                    Grid.Row="1"
                    Margin="0,0,0,5"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Bottom"
                    Orientation="Horizontal"
                    Spacing="5"
                    Visibility="{x:Bind IsProcessing, Mode=OneWay}">
                    <muxc:ProgressRing
                        Width="20"
                        Height="20"
                        IsActive="{x:Bind IsProcessing, Mode=OneWay}" />

                    <TextBlock Text="{x:Bind root:ResourceService.PriExtractResource.GetString('ProcessingNow')}" />
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</Page>
